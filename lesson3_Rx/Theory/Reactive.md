# Реактивка

Здесь обсудим реактивное программинование и как оно находит применение в современном мире.

## Вступление

Начнем с двух основных стратегий программирования - пассивной и реактивной.

## "Пассивное" программирование

Но сперва о том, что бывает – "пассивное" программирование. У моего друга есть учебный [проект][2].\
В нем интергирован Unsplash API и можно смотреть и лайкать фотки.
Менеджмент данных ревлизован через синглтон. Синглтон довольно пассивен и чаще всего не **он**, а\
**над ним** производятся манипуляции, что оч видно:

- [лайк фото][2];
- [сеттинг фото][3] в синглтон, после получения по сети;
- [получение][4] пролайканных фото.

Во всех случаях:

1. к синглтону обращаются откуда-то извне
2. синглтон вообще не знает, что к нему будут обращаться
2. ВК зависит от синглтона

## "Реактивное" программирование

А вот если бы в ВК мы прописали какой-то метод, который был бы как callBack:

```swift
/// Вот как это бы выглядело в самом ВК
public func onLikeAdded(completion: @escaping (Photo) -> Void) {
  completion()
}

/// А вот так это бы выглядело уже в синглтоне
func didLoad() {
  VC.onLikeAdded { photo in
    self.update(photo)
  }
}
```

Вот здесь мы уже говорим о том, что синглтон знает о ВК и реактивным образом реагирует на его изменения.

## THAT BEING SAID

> REACTIVE PROGRAMMING - ЭТО КОГДА МОДУЛЬ, КОТОРЫЙ БУДЕТ ИЗМЕНЯТЬСЯ, НЕСЕТ ОТВЕТСТВЕННОСТЬ ЗА ОПРЕДЕЛЕНИЕ ЭТОГО ИЗМЕНЕНИЯ

Пассивное программирование = удалённый сеттинг, апдейт, взятие данных
Реактивное программирование = self обновляется сам, исходя их всех событий

Пассивное программирование = нужно искать юзкейсы по всему коду
Реактивное программирование = юзкейсы описаны в каждом классе

Excel, кстати, тоже реактивный.

<img align="left" src="/Users/dmitryaksyonov/Library/Application Support/typora-user-images/Screenshot 2022-02-19 at 12.54.39.png"/>

## Cобытия аналитики (еще кейс для закрепления)

Положим, что у нас есть три различных странички в итернете. Каждая из них при открытии отправляет какие-то

события аналитики через синглтон. ))).

Будет что-то вроде:

```swift
struct LoginPage: WebPage {
  
  private func didShow() {
  let event = Analytics.Event(rawValue: "lp_show")
    Analytics.shared.sendEvent(event)
  }
}
```

Какие кринжи в коде выше?

1. Синглтон
2. Аналитический юзкейс раскрыт не совсем там, где ожидается увидеть
3. Страница знает об аналитике
4. Формирование ивента также происходит не на стороне аналитики

<img align="left" src="/Users/dmitryaksyonov/Library/Application Support/typora-user-images/Screenshot 2022-02-19 at 13.04.00.png" alt="Screenshot 2022-02-19 at 13.04.00" style="zoom:70%;" />

Так может быть с большим количеством страниц.

Если же мы идем по реактивной волне, то мы просто освобождаем страницы от знаний об аналитике. Все юзкейсы перечислены в аналитике, а страницы только ответственны за уведомление о своем жизненном цикле.

## Источники

[Reactive Programming: Why It Matters][1]\
[Учебный проект Эмиля][2]

[1]: https://www.youtube.com/watch?v=49dMGC1hM1o&t=12s

[comment]: <Это уже ссылки на проект Эмиля (конкретный коммит, чтоб показать пассивную природу синглтона)>
[comment]: <и то, что у синглтона много зависимостей, которые трудно подсветить>

[2]: https://github.com/Wtclrsnd/UnsplashGallery/blob/ad5d02acbb8bbe2ec2148f45ba2d19d4a3bfde12/whiteNFluffyTest/Controllers/DetailPhotoViewController.swift#L94
[3]: https://github.com/Wtclrsnd/UnsplashGallery/blob/8e4fc7433b050efc31691c28cf76d0049e92c5b7/whiteNFluffyTest/Controllers/UnsplashViewController.swift#L99
[4]: https://github.com/Wtclrsnd/UnsplashGallery/blob/8e4fc7433b050efc31691c28cf76d0049e92c5b7/whiteNFluffyTest/Controllers/LikedImagesViewController.swift#L73
